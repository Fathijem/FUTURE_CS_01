## 1. Insecure Direct Object Reference (IDOR)
IDOR is an access control vulnerability where an application exposes a reference (such as a parameter, file name, or record ID) to an internal object, allowing an attacker to manipulate it to gain unauthorized access to data or functionality.
If access control checks are missing or insufficient, changing these references can allow attackers to read, modify, or delete resources they shouldn’t have access to.

**Severity**: High

**CVSS**: 8.7

---

## 2. Impact
- Unauthorized Data Access – Viewing or modifying other users’ data.
- Privilege Escalation – Changing objects belonging to higher-privileged accounts.
- Fraudulent Transactions – Altering parameters to bypass payment or quantity restrictions.
- Business Logic Abuse – Tampering with order quantities, prices, or internal records.

---

## 3. Attack Vector
The vulnerability lies in parameters such as:
id=  
ticket_price=  
secret=  
These values directly reference backend objects without verifying user authorization.

---

## 4. Vulnerability Scan
This vulnerability was identified by navigating through the application and observing parameters in forms and hidden fields.
Using OWASP ZAP and manual inspection, it was confirmed that changing these parameters in requests affects data without any authentication or authorization enforcement.
<img width="621" height="271" alt="image" src="https://github.com/user-attachments/assets/823c5e55-92df-45c8-a1ea-84eef1918b11" />

---

## 5. How the Attack is Performed
**Case 1 – Changing User Secret**
Normal Behavior – User changes their own secret. In this case the user is bee.
<img width="752" height="92" alt="image" src="https://github.com/user-attachments/assets/dc5fdb8a-8a77-48dc-8fff-bc4487476775" />

Tampering with Hidden Parameter – Modify the hidden id field in the request to another user’s ID (hacker)
<img width="752" height="388" alt="image" src="https://github.com/user-attachments/assets/cd567741-f4dd-4e36-89dc-fc655793cb12" />

Result – The secret of another account (hacker) is changed in the database.
<img width="752" height="74" alt="image" src="https://github.com/user-attachments/assets/08927fa2-001d-4f07-9357-e9a537c664d1" />

**Case 2 – Ordering Tickets without Proper Authorization**
Normal Order Page – User enters a number of tickets, each costing €15.
<img width="752" height="301" alt="image" src="https://github.com/user-attachments/assets/1874a4ea-e46f-4dd6-8ba8-48f32594f7d7" />
Result of normal ticket orde:
<img width="752" height="318" alt="image" src="https://github.com/user-attachments/assets/2f35ede7-1660-4a0a-8e68-5d605e383ebe" />

Tampering with Client-Side Code – Modify hidden ticket_price or ticket_quantity using browser developer tools. Setting the value to 0.
<img width="752" height="350" alt="image" src="https://github.com/user-attachments/assets/7262834f-f67d-454f-9485-8b077b2a1b94" />

Result – Purchase is made with altered quantities or total price without proper checks.
<img width="752" height="263" alt="image" src="https://github.com/user-attachments/assets/d89cd6d5-f1d0-4b58-910c-9439411d8e35" />

---

## 6. Prevention and Mitigation
| Method                  | Description |
|-------------------------|-------------|
| **Enforce Access Control** | Verify user authorization on every server-side request. |
| **Avoid Direct References** | Use indirect references or mapping IDs instead of exposing real object identifiers. |
| **Server-Side Validation**  | Never trust client-side parameters for security checks. |
| **Use Session Data**        | Derive sensitive object IDs from the logged-in session rather than from user input. |
| **Security Testing**        | Regularly test for IDOR vulnerabilities using tools and manual reviews. |


